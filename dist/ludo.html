<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="tailwind.css" />
  </head>

  <body class="bg-gray-900 text-white">
    <div id="elm-app-is-loaded-here"></div>
    <script src="ludo.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <script>
      var app = Elm.Game.init({
        node: document.getElementById('elm-app-is-loaded-here'),
      });

      var socket = io();

      app.ports.rollDice.subscribe(function (message) {
        app.ports.diceRolledReceiver.send(Math.floor(Math.random() * 6) + 1);
      });

      app.ports.moveCoins.subscribe(function (message) {
        console.log(message);
        app.ports.moveCoinsReceiver.send(message);
      });

      app.ports.joinGame.subscribe(function (roomName) {
        socket.emit('join_room', {roomName}, (data) => {
          console.log(data);
          if (data.error) {
            app.ports.errorReceiver.send(data.error);
          } else {
            app.ports.joinGameReceiver.send(roomName);
          }
        });
      });
    </script>
  </body>
</html>
